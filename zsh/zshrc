setopt autocd extendedglob
unsetopt beep
bindkey -v
# End of lines configured by zsh-newuser-install

# Check platform
uname=$(uname)

# ======================
# zplug (plugin manager)
# ======================
# Check if zplug is installed
if [[ ! -d ~/.zplug ]]; then
  git clone https://github.com/zplug/zplug "$HOME/.zplug/"
fi
# zplug dependency script
source ~/.zplug/init.zsh
# manage zplug as a zplug plugin
zplug 'zplug/zplug', hook-build:'zplug --self-manage'

# =======
# plugins
# =======
# TODO: organize this list
zplug "modules/environment", from:prezto               # Sets general shell options and defines environment variables.
zplug "modules/terminal", from:prezto                  # Sets terminal window and tab titles.
zplug "modules/git", from:prezto
zplug "modules/command-not-found", from:prezto         # suggests package name
zplug "modules/tmux", from:prezto
zplug "modules/fasd", from:prezto                      # autojump
zplug "modules/utility", from:prezto                   # Defines general aliases and functions.
zplug "modules/history", from:prezto
zplug "modules/syntax-highlighting", from:prezto
zplug "modules/history-substring-search", from:prezto

zplug "modules/osx", from:prezto, if:"[[ $uname == *Darwin* ]]"
zplug "modules/homebrew", from:prezto, if:"[[ $uname == *Darwin* ]]"

zplug "modules/pacman", from:prezto, if:"[[ $uname == *Linux* ]]"

zplug "TBSliver/zsh-plugin-colored-man" # colored manpages
zplug "caarlos0/zsh-git-sync"           # Sync git repositories and clean them up.
# autosuggestions must be loaded after zsh-syntax-highlighting
zplug "tarruda/zsh-autosuggestions"
zplug "djui/alias-tips"                 # suggests aliases

zplug "plugins/colored-man-pages", from:oh-my-zsh
zplug "plugins/colorize", from:oh-my-zsh          # cat with syntax highlighting
zplug "plugins/cp", from:oh-my-zsh                # cp with progress bar (rsync)
zplug "plugins/common-aliases", from:oh-my-zsh

# --------------
# plugin options
# --------------
zstyle ':prezto:editor' key-bindings 'vi'
zstyle ':prezto:terminal' auto-title 'yes'
zstyle ':prezto:tmux:auto-start' local 'yes'
zstyle ':prezto:tmux:iterm' integrate 'yes'
zstyle ':prezto:*:*' case-sensitive 'yes'
zstyle ':prezto:*:*' color 'yes'

# -----
# Theme
# -----
# zstyle ':prezto:prompt' theme 'sorin'
# see https://github.com/sorin-ionescu/prezto/issues/1245
# function revert-expand-or-complete { zle expand-or-complete }
# zle -N expand-or-complete-with-indicator revert-expand-or-complete
zplug "mafredri/zsh-async" # required for pure
zplug sindresorhus/pure, use:pure.zsh, from:github, as:theme

# ===============
# Install plugins
# ===============
if ! zplug check; then
    printf "Install? [y/N]: "
    if read -q; then
        echo; zplug install
    fi
fi

# ==============
# Source plugins
# ==============
zplug load

export TERM='screen-256color'

alias yolo='pacaur -Syuu --noconfirm'

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
